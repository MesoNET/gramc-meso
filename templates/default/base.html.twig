{# app/Resources/views/default/base.html.twig #}

{% import "default/macros.html.twig" as gramcmacros %}

{% import "default/icone.html.twig" as icones %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Plateforme d'attribution de ressources de {{ mesoc }}</title>
    <link rel="icon" href="{{ absolute_url(asset('icones/favicon.ico')) }}"/>

    {% block stylesheets %}

        <link href="{{ absolute_url(asset('js/jquery-ui/jquery-ui.css')) }}" rel="stylesheet" type="text/css"
              media="screen"/>
        <link href="{{ absolute_url(asset('js/jquery-upload-file-master/css/uploadfile.css') ) }}" rel="stylesheet"
              type="text/css" media="screen"/>
        <link href="{{ absolute_url(asset('js/DataTables-1.11.5/css/jquery.dataTables.min.css') ) }}" rel="stylesheet"
              type="text/css" media="screen"/>
        <link href="{{ absolute_url(asset('css/styles.css')) }}" rel="stylesheet" type="text/css" media="screen"/>
        <link href="{{ absolute_url(asset('css/colors.css')) }}" rel="stylesheet" type="text/css" media="screen"/>
        <link href="{{ absolute_url(asset('css/gramc3.css')) }}" rel="stylesheet" type="text/css" media="screen"/>
    {% endblock stylesheets %}

    {% block mystyles %}
    {% endblock mystyles %}

    {% block javascripts %}
        <script src="{{ absolute_url(asset('js/jquery-3.6.0.min.js') ) }}"></script>
        <script src="{{ absolute_url(asset('js/jquery-ui/jquery-ui.js') ) }}"></script>
        <script src="{{ absolute_url(asset('js/header_fixe.js') ) }}"></script>
        <script src="{{ absolute_url(asset('js/base.js') ) }}"></script>
        <script src="{{ absolute_url(asset("libs/jquery/dist/jquery.min.js")) }}"></script>
        <script src="{{ absolute_url(asset("libs/bootstrap/dist/js/bootstrap.bundle.min.js")) }}"></script>
        <script src="{{ absolute_url(asset("js/sidebarmenu.js")) }}"></script>
        <script src="{{ absolute_url(asset("js/app.min.js")) }}"></script>
        <script src="{{ absolute_url(asset("libs/apexcharts/dist/apexcharts.min.js")) }}"></script>
        <script src="{{ absolute_url(asset("libs/simplebar/dist/simplebar.js")) }}"></script>
        <script src="{{ absolute_url(asset("js/dashboard.js")) }}"></script>
    {% endblock javascripts %}

    {% block myjavascripts %}
    {% endblock myjavascripts %}

    {% block datatables %}
        <script src="{{ absolute_url(asset('js/DataTables-1.11.5/js/jquery.dataTables.min.js') ) }}"></script>
        <script src="{{ absolute_url(asset('js/datatable.js') ) }}"></script>
    {% endblock datatables %}

</head>

<body>
{% block header %}
{% if not app.request.xmlhttprequest %}
<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
     data-sidebar-position="fixed" data-header-position="fixed">
    <!-- Sidebar Start -->
    <aside class="left-sidebar">
        <!-- Sidebar scroll-->
        <div class="side">
            <div class="brand-logo d-flex align-items-center justify-content-between">
                <a href="{{ path('accueil') }}" class="text-nowrap logo-img" title="Accueil">
                    <img src="{{ asset('icones/banniere.jpg') }}" width="180" alt="logo"/>
                </a>
                <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
                    <i class="ti ti-x fs-8"></i>
                </div>
            </div>
            <!-- Sidebar navigation-->
            <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
                <ul id="sidebarnav">
                    <li class="nav-small-cap">
                        <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">Projet</span>
                    </li>
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        {% if is_granted('ROLE_DEMANDEUR') %}
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('projet_accueil') }}" aria-expanded="false"
                                   title="Accéder à l'espace valideur">
                                    <i class="ti ti-alert-circle"></i>
                                    <span class="hide-menu">Dashboard</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('projet_accueil') }}" aria-expanded="false"
                                   title="Accéder à l'espace valideur">
                                    <i class="ti ti-alert-circle"></i>
                                    <span class="hide-menu">Liste des projets</span>
                                </a>
                            </li>
                        {% endif %}
                    {% endif %}
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        {% if is_granted('ROLE_VALIDEUR') %}
                            <li class="nav-small-cap">
                                <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                                <span class="hide-menu">VALIDEUR</span>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('expertise_liste_dyn') }}" aria-expanded="false"
                                   title="Accéder à l'espace valideur">
                                <i class="ti ti-alert-circle"></i>
                                <span class="hide-menu">projet à valider</span>
                                </a>
                            </li>
                        {% endif %}
                    {% endif %}
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        {% if is_granted('ROLE_OBS') %}
                            <li class="nav-small-cap">
                                <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                                <span class="hide-menu">ADMIN</span>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('admin_accueil') }}" aria-expanded="false"
                                   title="Accéder à l'espace Administrateur">
                                <i class="ti ti-cards"></i>
                                <span class="hide-menu">tous</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('individu_gerer') }}" aria-expanded="false"
                                   title="Accéder à l'espace Administrateur">
                                    <i class="ti ti-cards"></i>
                                    <span class="hide-menu">Utilisateur</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('connexions') }}" aria-expanded="false"
                                   title="Accéder à l'espace Administrateur">
                                    <i class="ti ti-cards"></i>
                                    <span class="hide-menu">Personnes connéctés</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('journal_list') }}" aria-expanded="false"
                                   title="Accéder à l'espace Administrateur">
                                    <i class="ti ti-cards"></i>
                                    <span class="hide-menu">Logs</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('statistiques_dyn') }}" aria-expanded="false"
                                   title="Accéder à l'espace Administrateur">
                                    <i class="ti ti-cards"></i>
                                    <span class="hide-menu">Statisitique dynamique</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('gerer_laboratoires') }}" aria-expanded="false"
                                   title="Accéder à l'espace Administrateur">
                                    <i class="ti ti-cards"></i>
                                    <span class="hide-menu">Laboratoires</span>
                                </a>
                            </li>
                        {% endif %}
                    {% endif %}
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        {% if is_granted('ROLE_PRESIDENT') %}
                            <li class="nav-small-cap">
                                <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                                <span class="hide-menu">PRESIDENT</span>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link" href="{{ path('president_accueil') }}"
                                   title="Accéder à l'espace Président" aria-expanded="false">
                                <i class="ti ti-file-description"></i>
                                <span class="hide-menu">président</span>
                                </a>
                            </li>
                        {% endif %}
                    {% endif %}
                    <li class="nav-small-cap">
                        <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">AUTH</span>
                    </li>
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="{{ path('deconnexion') }}" aria-expanded="false" title="Déconnexion">
                                            <span>
                                              <i class="ti ti-login"></i>
                                            </span>
                                <span class="hide-menu">Déconnexion</span>
                            </a>
                        </li>
                    {% else %}
                        {% if mode_auth == 'saml2' %}
                            <li class="sidebar-item">
                                <a class="sidebar-link" href=" {{ path('connexion') }}" aria-expanded="false" title="Connexion">
                                                <span>
                                                  <i class="ti ti-login"></i>
                                                </span>
                                    <span class="hide-menu">Connexion</span>
                                </a>
                            </li>
                        {% endif %}
                        {% if mode_auth == 'openid' %}
                            <li class="sidebar-item">
                                <a class="sidebar-link" href=" {{ path('remlogin') }}" aria-expanded="false" title="Connexion">
                                                <span>
                                                  <i class="ti ti-login"></i>
                                                </span>
                                    <span class="hide-menu">Connexion</span>
                                </a>
                            </li>
                        {% endif %}
                        {% if app.debug %}
                            <li class="sidebar-item">
                                <a class="sidebar-link" href=" {{ path('connexion_dbg') }}" aria-expanded="false" title="Connexion (DBG)">
                                                <span>
                                                  <i class="ti ti-login"></i>
                                                </span>
                                    <span class="hide-menu">Connexion (DBG)</span>
                                </a>
                            </li>
                        {% endif %}
                    {% endif %}
                    <li class="nav-small-cap">
                        <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">EXTRA</span>
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link" href="{{ path('aide') }}" aria-expanded="false" title="Aide">
                                        <span>
                                          <i class="ti ti-mood-happy"></i>
                                        </span>
                            <span class="hide-menu">Aide</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link sidebar-icon" href="https://tickets.mesonet.fr/" title="Ticket">
                                <span>
                                    <i class="ti ti-key"></i>
                                </span>
                            <span class="hide-menu">ticket</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link sidebar-icon" href="https://www.mesonet.fr/documentation/user-documentation/" title="Documentation">
                                <span>
                                    <i class="ti ti-key"></i>
                                </span>
                            <span class="hide-menu">documentation</span>
                        </a>
                    </li>
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        <li class="sidebar-item">
                            <a class="sidebar-link sidebar-icon" href="{{ path('gerer_clessh') }}" title="Gérer vos clés ssh">
                                <span>
                                    <i class="ti ti-key"></i>
                                </span>
                                <span class="hide-menu">Clés ssh</span>
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
            <!-- End Sidebar navigation -->
        </div>
        <!-- End Sidebar scroll-->
    </aside>
    <!--  Sidebar End -->
    <!--  Main wrapper -->
    <div class="body-wrapper">
        <!--  Header Start -->
        <header class="app-header">
            <nav class="navbar navbar-expand-lg navbar-light">
                <ul class="navbar-nav">
                    <li class="nav-item d-block d-xl-none">
                        <a class="nav-link sidebartoggler nav-icon-hover" id="headerCollapse" href="">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>
                </ul>
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <div class="navbar-collapse justify-content-end px-0" id="navbarNav">
                    <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
                        <li class="nav-item dropdown">
                            <a class="nav-link nav-icon-hover" href="" id="drop2" data-bs-toggle="dropdown"
                               aria-expanded="false"
                               title="Notifications">
                                <i class="ti ti-bell-ringing"></i>
                                {% if app.user.notifications|length >0 %}
                                    <span class="badge rounded-pill badge-notification bg-danger">{{ app.user.notifications|length }}</span>
                                {% endif %}
                                {% if app.user.notifications|length >100 %}
                                    <span class="badge rounded-pill badge-notification bg-danger">99+</span>
                                {% endif %}
                            </a>
                            <div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up"
                                 aria-labelledby="drop2">
                                <div class="message-body justify-content-center">
                                    {% include "notification/notifications.html.twig" %}
                                    <a href="{{ path('notifications') }}"
                                       class="d-flex align-items-center justify-content-center gap-2 dropdown-item"
                                       title="Voire plus">
                                        <p class="mb-0 fs-3">Voire plus</p>
                                    </a>
                                </div>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link nav-icon-hover" href="" id="drop2" data-bs-toggle="dropdown"
                               aria-expanded="false"
                               title="Utilisateur">
                                <i class="ti ti-user"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up"
                                 aria-labelledby="drop2">
                                <div class="message-body">
                                    <a href="{{ path('profil')}}" class="d-flex align-items-center gap-2 dropdown-item" title="Mon profile">
                                        <i class="ti ti-user fs-6"></i>
                                        <p class="mb-0 fs-3">Mon profile</p>
                                    </a>
                                    <a href="{{ path('profil')}}" class="d-flex align-items-center gap-2 dropdown-item" title="Mon compte">
                                        <i class="ti ti-mail fs-6"></i>
                                        <p class="mb-0 fs-3">Mon compte</p>
                                    </a>
                                    <a href="{{ path('notifications')}}" class="d-flex align-items-center gap-2 dropdown-item" title="Mon tâches">
                                        <i class="ti ti-list-check fs-6"></i>
                                        <p class="mb-0 fs-3">Mes tâches</p>
                                    </a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                {% endif %}
            </nav>
        </header>


        <div class="sous_header">
            <p>&nbsp;</p>
            <div class="profil">
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <div>
                        {% if is_granted('IS_IMPERSONATOR') %}
                            <p> SUDO par {{ app.token.originalToken.user }}</p>
                        {% endif %}
                        <p>
                            {% if app.debug %}
                        <p>Connecté en tant que : <a href="{{ path('profil') }}"
                                                     class="nom_profil">{{ app.user.prenom }} {{ app.user.nom }}
                                ({{ app.user.id }})</a>
                            {% else %}
                        <p>Connecté en tant que : <a href="{{ path('profil') }}"
                                                     class="nom_profil">{{ app.user.prenom }} {{ app.user.nom }}
                                ({{ app.user.id }})</a>
                            {% endif %}
                    </div>
                {% else %}

                {% endif %}

            </div>
        </div>

        {% set scrollTop = "fleche" %}

        <div id="scrollTop">
            <a class="fleche">
                {{ icones.scrollTop }}
            </a>
        </div>


        {% endif %} {# si ajax on saute tout ça #}
        {% endblock header %}

        {# ###################################################################### #}
        <div class="container-fluid">
                    {% block menu %}
                    {% endblock menu %}

                    {% block before_body %}
                    {% endblock before_body %}

                    {% block body %}
                    {% endblock body %}

                    {% block after_body %}
                    {% endblock after_body %}
        </div>
    </div>
    <br><br>
    {% block footer %}
        {# footer #}
        <footer class="footer">
            <div>
                {{ infos.gramc_date('Y-m-d') }}
            </div>
            <div class="liens_importants_footer">
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <span>gramc-meso {{ infos.VERSION }} - design <a
                                href="https://fr.linkedin.com/in/ugo-mariotto-952aa21b8"
                                target='_blank'>Ugo Mariotto</a> - <a href="mailto:{{ mailadmin }}"
                                                                      class="lien_footer">{{ mailadmin }}</a></span>
                {% else %}
                    <span>gramc-meso {{ infos.VERSION }} - design <a
                                href="https://fr.linkedin.com/in/ugo-mariotto-952aa21b8"
                                target='_blank'>Ugo Mariotto</a> - {{ infos.mail_replace(mailadmin) }}</span>
                {% endif %}
                {% if mentions_legales != null %}
                    &nbsp;<a href="{{ asset(mentions_legales) }}" target="_blank" class="lien_footer"
                             title="Lire les mentions légales"> Mentions légales </a>
                {% endif %}
                {% if mesoc_cga != null %}
                    &nbsp;<a href="{{ asset(mesoc_cga) }}" target="_blank" class="lien_footer"
                             title="Lire les conditions Générales d'Attribution">cga</a>
                {% endif %}
            </div>

        </footer>

    {% endblock footer %}
</div>
</body>

</html>

